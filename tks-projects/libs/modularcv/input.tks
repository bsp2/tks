// ----
// ---- file   : input.tks
// ---- author : Bastian Spiegel <bs@tkscript.de>
// ---- legal  : (c) 2021 by Bastian Spiegel.
// ----          Distributed under terms of the GNU LESSER GENERAL PUBLIC LICENSE (LGPL). See
// ----          http://www.gnu.org/licenses/licenses.html#LGPL or COPYING for further information.
// ----
// ---- info   :
// ----
// ---- created: 26Mar2021
// ---- changed: 29Mar2021, 30Mar2021, 31Mar2021, 16Apr2021
// ----
// ----
// ----

module MModularCVInput;

namespace modularcv;


class Input {
   Module     *parent_module;
   int         index;
   String      id;
   String      tooltip;
   Module     *source;
   int         source_output_index;
   float       def_value;  // no source is connected
   int         io_class;   // 0=IO_ANY, 1=IO_CV, 2=IO_GATE, 3=IO_SCALE, 4=IO_OFF
   PortWidget *port_widget;

   boolean b_mouseover_highlight;

   int palette_idx;  // see STConfig.modular_cable_colors


   public method init() {
   }

   public method getValue() : float {
      if(null != source)
         return source.getOutputValueByIndex(source_output_index);
      else
         return def_value;
   }

   public method isConnected() : boolean {
      return (null != source);
   }

   public method getOutput() : Output {
      if(null != source)
         return source.getOutputByIndex(source_output_index);
      else
         return null;
   }

   public method disconnect() {
      if(null != source)
         source.handleOutputDisconnect(source_output_index);

      source <= null;
      source_output_index = -1;
   }
}
