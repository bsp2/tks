// 20Aug2024

//  +0: host pid
//  +4: client pid
//  +8: request data from client (iter)
// +12: reply data from host (-request data)
SharedBuffer sh;
if(sh.allocSharedMemoryByKey("test_sigusr1", 16+256*1024))
{
   sh.fillZero();
   sh.pokeI32(0, Process.GetPID());
   loop(10000)
   {
      Process.WaitSignal_SIGUSR1();
      int clientPID = sh.peekI32(4);
      if(clientPID > 0)
      {
         // Send reply
         sh.pokeI32(12, -sh.peekI32(8));
         Process.SendSignal_SIGUSR1(clientPID);
         // Thread.Yield();  // (a bit) slower with Yield()
      }
      else
         trace "xxx host: invalid clientPID="+clientPID;
   }
}
trace "host: cu";
