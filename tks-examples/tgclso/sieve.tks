/* -*- mode: c -*-
 * $Id: sieve.gcc,v 1.7 2001/05/06 04:37:45 doug Exp $
 * http://www.bagley.org/~doug/shootout/
 *
 * 0.488s (amd athlon 2500+, 55,245 times faster than interpreted mode)
 * 26.960s (amd athlon 2500+, interpreted mode)
 *
 * v0.9.10.72 intel q9550@2.83GHz, NUM=9000
 *    1919ms (JIT)
 *   27097ms (interpreted) (14,12 times slower than JIT)
 *   
 */

int t=milliSeconds();
int NUM = 900;
int flags[8192 + 1]; flags.numElements=flags.maxElements;
int i, k;
int count = 0;
compile
while (NUM--) {
    count = 0; 
    for (i=2; i <= 8192; i++) {
	flags[i] = 1;
    }
    for (i=2; i <= 8192; i++) {
	if (flags[i]) {
	    // remove all multiples of prime: i
	    for (k=i+i; k <= 8192; k+=i) {
		flags[k] = 0;
	    }
	    count++;
	}
    }
}
t=milliSeconds()-t;
trace "time(ms)="+t;
trace "Count: "+ count;

