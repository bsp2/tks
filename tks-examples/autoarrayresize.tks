//
// name: autoarrayresize.tks
// date: 30-Sep-2004
// info: test automatic array resizing 
//       this feature can be disabled using the "-nra" command line option
//       requires tkscript 0.9.0.6+
//

int i,j;

// ---- test IntArray autoresizing ----
IntArray ia;
i=0;
j=0;
loop(10000)
{
    ia[i++]=j;
    j+=10;
}

print "ia.numElements="+ia.numElements;
print "ia.maxElements="+ia.maxElements;


// ---- test FloatArray autoresizing ----
FloatArray fa;
i=0;
float f=0;
loop(10000)
{
    fa[i++]=f;
    f+=1.1;
}

print "fa.numElements="+fa.numElements;
print "fa.maxElements="+fa.maxElements;

// ---- test StringArray autoresizing ----
StringArray sa;
i=0;
String s="test";
loop(1000)
{
    sa[i++]=s;
    s+="test";
}

print sa[i-1];
print "sa.numElements="+sa.numElements;
print "sa.maxElements="+sa.maxElements;


// ---- test (generic) ObjectArray autoresizing ----
Integer ioa[];
Integer io;
i=0;
j=0;
loop(1000)
{
    io.value=j;
    ioa[i++]=io;
    j+=10;
}

i--; // rewind to last used index
print "ioa["+i+"].value="+ioa[i].value;
print "ioa.numElements="+ioa.numElements;
print "ioa.maxElements="+ioa.maxElements;


// ---- test PointerArray autoresizing ----
PointerArray pa;
i=0;
j=0;
loop(1000)
{
    pa[i++]=ioa[j++];
}

i--; // rewind to last used index
print "pa["+i+"].value="+pa[i].value;
print "pa.numElements="+pa.numElements;
print "pa.maxElements="+pa.maxElements;


// ---- test ClassArray autoresizing ----
class MyClass { int a,b; }
MyClass mc;
MyClass mca[];
i=0;
j=0;
loop(1000)
{
    mc.a=j;
    mca[i++]=mc;
    j+=10;
}

i--; // rewind to last used index
print "mca["+i+"].a="+mca[i].a;
print "mca.numElements="+mca.numElements;
print "mca.maxElements="+mca.maxElements;


// ---- test Buffer autoresizing ----
Buffer b;
i=0;
j=0;
loop(1000)
{
    b[i++]=j;   // write byte
    j=(j+1)&255;
}

i--; // rewind to last used index
print "b["+i+"].a="+b[i];
print "b.offset="+b.offset;
print "b.size="+b.size;

