//

module Main;

class MyPoolEntry {
    String name;
}

function main() {
    Pool pool;
    int i;
    int id;
    MyPoolEntry ce;
    String s;

    pool.template=MyPoolEntry;
    pool.alloc(32);
    loop(10)
	{
	    id=pool.qAlloc();
	    ce<=pool[id];
	    ce.name="poolentry_"+id;
	}
    i=0;
    foreach id in pool 
	{
	    trace("foreach qFree i=="+i);
	    if(++i<5)
		{
		    pool.qFree(id);   // detach entry, does not affect iterated list
		}
	    else
		id=-1; // end foreach
	}
    foreach id in pool
	{
	    ce<=pool[id];
	    s<=ce.name;
	    trace("foreach entry \""+s+"\"\n");
	}
    pool.free();
}

