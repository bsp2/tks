
// simple vertexarray test that uses a float color array

use tksdl;
use tkopengl;

int numframesrendered=0;

FloatArray verts = [
   -1, -1,
    1, -1,
    1,  1,
   -1,  1
                    ];

FloatArray cols = [
   1.0, 1.0, 1.0, 1.0,
   1.0, 0.0, 0.0, 1.0,
   1.0, 1.0, 0.0, 1.0,
   0.0, 1.0, 1.0, 1.0
                   ];


function onDraw() {
   float dt=FPS.precision;

   glClearColor(0,0,0.2,1);
   glClear(GL_COLOR_BUFFER_BIT);

   if( !(++numframesrendered&127) )
      trace "FPS.real="+FPS.real;

   zglInitOrtho(1, 1);

   zglVertexPointer2f(verts);
   glEnableClientState(GL_VERTEX_ARRAY);

   zglColorPointer4f(cols);
   glEnableClientState(GL_COLOR_ARRAY);

   glDrawArrays(GL_QUADS, 0, 4);

   glDisableClientState(GL_COLOR_ARRAY);
   glDisableClientState(GL_VERTEX_ARRAY);
}

function onKeyboard(Key _k) {
   switch(_k.pressed)
   {
      case VKEY_ESCAPE:
         SDL.exitEventLoop();
         break;
   }
}

function main() {
   use callbacks;

   FPS.tickInterval=1000.0/60;
   FPS.limit=60;

   Viewport.openWindow(640, 480);

   trace "xxx entering eventloop";
   SDL.eventLoop();
}
