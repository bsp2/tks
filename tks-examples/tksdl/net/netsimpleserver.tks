///
/// file   : netsimpleserver.tks
/// author : Bastian Spiegel <bastian.spiegel@web.de>
/// descr. : simple test server using TCPServer module
/// license: do whatcha want but:  NO WARRANTIES OR FITNESS FOR A PARTICULAR PURPOSE..
/// created: 240402
/// changed:
///
///
module Main;

TCPServer myserver;

function onTCPServerRecv(Object _sock, Object _buf) {
    TCPSocket s<=_sock;
    Buffer buf<=_buf;
    String t<=buf.getString(0,0);
    trace "received "+buf.offset+" bytes.(\""+t+"\")";
}


function main() {

    Buffer xferbuf;
    xferbuf.setSize(256);

    if(myserver.start(64064, 16))
	{
	    while(1)
		{
		    // wait for activity and process clients
		    myserver.process(xferbuf);
		    myserver.keepAlive();
		}
	}
    else
	{
	    die "[---] failed to create server socket. ups.";
	}
    
}



