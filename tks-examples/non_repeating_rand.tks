//
// Non-repeating random number sequence
//  (note) use LFSR instead for large sequences 
//
// 31Dec2018
//

class NonRepeatingRand {
   IntArray ia;
   int num_left;

   public init(int _seqLen) {
      ia.identity(_seqLen);
      num_left = _seqLen;
   }

   public getRand() : int {
      int r;
      if(1 == num_left)
      {
         return = ia.get(0);
         num_left--;
         return;
      }
      else if(0 == num_left)
      {
         num_left = ia.numElements;
         do r = rand(num_left);
         while(0 == r);
      }
      else
      {
         r = rand(num_left);
      }
      return = ia.get(r);
      ia.swap(r, --num_left);
      return;
   }
}

NonRepeatingRand nrr;
nrr.init(3);

loop(10)
{
   loop(3)
   {
      trace nrr.getRand();
   }
   trace "..";
}
