
int ia[10];
trace "xxx ia="+#(ia);
trace "";

String sa[10];
trace "xxx sa="+#(sa);
trace "";

Double*[] *doubleptr_array_ref;         // => PointerArray ref (initially null)
trace "xxx null doubleptr_array_ref="+#(doubleptr_array_ref);

Double*[] doubleptr_array_instance;     // => PointerArray instance
trace "xxx doubleptr_array_instance="+#(doubleptr_array_instance);

String[] *string_array_ref;         // => StringArray ref (initially null)
trace "xxx null string_array_ref="+#(string_array_ref);
string_array_ref <= new StringArray;
string_array_ref.add("hello");
trace "xxx add string_array_ref="+#(string_array_ref);

String[] string_array_instance;         // => StringArray instance
trace "xxx string_array_instance="+#(string_array_instance);

String*[] stringptr_array_instance;         // => PointerArray instance
trace "xxx stringptr_array_instance="+#(stringptr_array_instance);

class MyClass {
   String s;
   MyClass() { s = "hello, world."; }
}

class C {
   int ia_empty[];                      // => IntArray instance
   int ia[10];                          // => IntArray instance
   int[]*ia_ref;                        // => IntArray ref (initially null)
   IntArray *ia_ref2;                   // => IntArray ref (initially null)
   String sa_empty[];                   // => StringArray instance
   String *sa_pa_empty[];               // => PointerArray instance
   String *sa_pa[11];                   // => PointerArray instance
   String sa[10];                       // => StringArray instance
   Double *double_ptrs[];               // => PointerArray instance
   Double*[] *doubleptr_array_ref;      // => PointerArray ref (initially null)
   Double double_object_array[];        // => ObjectArray instance
   Double[] *double_object_array_ref;   // => ObjectArray ref (initially null)
   String[]  array_of_stringarrays[];      // => PointerArray instance (initially null)
   String[] *array_of_stringarrays_ref[];  // => PointerArray instance (initially null)
   Double[]  array_of_doublearrays[5];     // => PointerArray instance (initially null)
   Double[] *array_of_doublearrays_ref[];  // => PointerArray instance (initially null)
   MyClass myclass_array[5];
   MyClass[] myclass_array_short;
   MyClass[] *myclass_array_ref;

   test() {
      trace "xxx this.ia="+#(ia);
      trace "xxx this.ia.maxElements="+ia.maxElements;
      trace "";

      trace "xxx null this.ia_ref="+#(ia_ref);
      ia_ref <= ia;
      trace "xxx ref this.ia_ref="+#(ia_ref);
      ia_ref.add(42);
      trace "xxx add this.ia_ref="+#(ia_ref);
      trace "";

      trace "xxx this.sa_pa="+#(sa_pa);
      trace "xxx this.sa_pa.maxElements="+sa_pa.maxElements;
      trace "";

      trace "xxx this.sa="+#(sa);
      trace "xxx this.sa.maxElements="+ia.maxElements;
      trace "";

      double_ptrs.add(#(new Double));
      trace "xxx this.double_ptrs="+#(double_ptrs);
      trace "";

      trace "xxx this.double_object_array="+#(double_object_array);
      double_object_array.add(#(new Double));
      trace "xxx add this.double_object_array="+#(double_object_array);
      trace "xxx add this.double_object_array get0="+#(double_object_array.get(0));
      trace "";

      trace "xxx null this.double_object_array_ref="+#(double_object_array_ref);
      double_object_array_ref <= double_object_array;
      trace "xxx ref this.double_object_array_ref="+#(double_object_array_ref);
      trace "xxx ref this.double_object_array_ref get0="+#(double_object_array_ref.get(0));
      trace "";

      trace "xxx this.doubleptr_array_ref="+#(doubleptr_array_ref);
      doubleptr_array_ref <= double_ptrs;
      trace "xxx assign this.doubleptr_array_ref="+#(doubleptr_array_ref);
      trace "";

      trace "xxx empty this.array_of_stringarrays="+#(array_of_stringarrays);
      array_of_stringarrays.add(["one", "two", "three"]);
      trace "xxx add this.array_of_stringarrays="+#(array_of_stringarrays);
      trace "";

      trace "xxx null this.array_of_stringarrays_ref="+#(array_of_stringarrays_ref);
      array_of_stringarrays_ref <= array_of_stringarrays;
      array_of_stringarrays_ref.add(["four", "five", "six"]);
      trace "xxx add this.array_of_stringarrays_ref="+#(array_of_stringarrays_ref);
      trace "";

      trace "xxx this.array_of_doublearrays="+#(array_of_doublearrays);
      trace "xxx this.array_of_doublearrays.maxElements="+array_of_doublearrays.maxElements;
      array_of_doublearrays.add(double_object_array);
      trace "xxx this.array_of_doublearrays="+#(array_of_doublearrays);
      trace "";

      trace "xxx this.myclass_array="+#(myclass_array);
      myclass_array.add(#(new MyClass()));
      trace "xxx add this.myclass_array="+#(myclass_array);
      trace "xxx add this.myclass_array get0="+#(myclass_array.get(0));
      trace "xxx add this.myclass_array get0.s="+#(myclass_array.get(0).s);
      trace "";
      trace "xxx this.myclass_array_short="+#(myclass_array_short);
      trace "xxx null this.myclass_array_ref="+#(myclass_array_ref);
      myclass_array_ref <= myclass_array;
      trace "xxx ref this.myclass_array_ref="+#(myclass_array_ref);
      // trace "xxx add this.myclass_array_ref get0="+#(myclass_array_ref.get(0));
      // trace "xxx add this.myclass_array_ref get0.s="+#(myclass_array_ref.get(0).s);
      trace "";
   }

   testArgsObjectArray(Double _doubles[]) {
      trace "_doubles="+#(_doubles);
   }

   testArgsDoublePtrs(Double*[] _doubleptrs) {
      trace "_doubleptrs="+#(_doubleptrs);
   }

   testArgs_StringArray(String[] _stringarray) {
      trace "_stringarray="+#(_stringarray);
   }

   testArgsAoA_String(String[] _stringarrays[]) {
      trace "_stringarrays="+#(_stringarrays);
   }

   testArgsAoA_Double(Double[] _doublearrays[]) {
      trace "_doublearrays="+#(_doublearrays);
   }

   testArgsAoA_DoublePtr(Double*[] _doubleptrarrays[]) {
      trace "_doubleptrarrays="+#(_doubleptrarrays);
   }
}

C c;
c.test();
trace "";

// Double *array_of_doubles[7];
// trace "xxx array_of_doubles="+#(array_of_doubles);
// trace "xxx array_of_doubles.maxElements="+array_of_doubles.maxElements;
// trace "";

Double doubles[];
trace "xxx doubles="+#(doubles);
doubles.add(#(new Double));
trace "xxx add doubles="+#(doubles);
c.testArgsObjectArray(doubles);
trace "";

Double*[] doubleptrs;
trace "xxx doubleptrs="+#(doubleptrs);
doubleptrs.add(#(new Double));
trace "xxx add doubleptrs="+#(doubleptrs);
c.testArgsDoublePtrs(doubleptrs);
trace "";

String[] aoa_strings_empty[];
trace "xxx aoa_strings_empty="+#(aoa_strings_empty)+" (max="+aoa_strings_empty.maxElements+", should be 0)";
trace "";

String[] *aoa_strings_ref[];
trace "xxx null aoa_strings_ref="+#(aoa_strings_ref);
trace "";

String*[] aoa_stringptrs_empty[];
trace "xxx aoa_stringptrs_empty="+#(aoa_stringptrs_empty)+" (max="+aoa_stringptrs_empty.maxElements+", should be 0)";
trace "";

String*[] aoa_stringptrs[10];
trace "xxx aoa_stringptrs="+#(aoa_stringptrs)+" (max="+aoa_stringptrs.maxElements+", should be 10)";
trace "";

String*[] *aoa_stringptrs_ref[];
trace "xxx null aoa_stringptrs_ref="+#(aoa_stringptrs_ref);
trace "";

String[] stringarray;
stringarray = ["hello", "world"];
trace "xxx stringarray="+#(stringarray);
c.testArgs_StringArray(stringarray);
trace "";

String[] stringarrays[];
stringarrays.add(["hello", "world"]);
trace "xxx stringarrays="+#(stringarrays);
c.testArgsAoA_String(stringarrays);
trace "";

Double[] array_of_doublearrays[9];
trace "xxx array_of_doublearrays="+#(array_of_doublearrays);
array_of_doublearrays.add(doubles);
trace "xxx array_of_doublearrays.maxElements="+array_of_doublearrays.maxElements;
c.testArgsAoA_Double(array_of_doublearrays);
trace "";

Double*[] array_of_doubleptrarrays[4];
trace "xxx array_of_doubleptrarrays="+#(array_of_doubleptrarrays);
array_of_doubleptrarrays.add(doubleptrs);
trace "xxx array_of_doubleptrarrays.maxElements="+array_of_doubleptrarrays.maxElements;
c.testArgsAoA_DoublePtr(array_of_doubleptrarrays);
trace "";
