// ----
// ---- file   : TableCellEditorComboBox.tks
// ---- author : Bastian Spiegel <bs@tkscript.de>
// ---- legal  : (c) 2010-2018 by Bastian Spiegel. 
// ----          Distributed under terms of the GNU LESSER GENERAL PUBLIC LICENSE (LGPL). See 
// ----          http://www.gnu.org/licenses/licenses.html#LGPL or COPYING for further information.
// ----
// ---- info   : 
// ----
// ---- created: 22Jan2010
// ---- changed: 23Jan2010, 24Jan2010, 05Mar2018
// ----          
// ----          
// ----

module MTableCellEditorComboBox;

namespace ui;


class TableCellEditorComboBox : TableCellEditor {

   ComboBox *cm;

   public method initComboBoxEditor(StringArray _options, int _selOption) {
      initTableCellEditor();

      setLayout(SuperBorderLayout);

      cm <= new ComboBox;
      cm.setLayoutWeight2f(1.0, 1.0);

      cm.setOptions(_options);
      cm.setSelectedOption(_selOption);
      cm.initComboBox();

      addLayer(deref cm, Layout.CENTER);
   }

   public virtual consumeAction(Action _ac) {
      String acName <= _ac.getActionName();
      trace "xxx TableCellEditorComboBox: action=\""+acName+"\".";
      if(ComboBox.ACTION_OPTIONSELECTED == acName)
      {
         handleCellEditing();
      }
   }
   
   public virtual preShow() {

      resizeToMinimum();

      // Save keyboard focus
      old_keyboard_focus <= UI.GetKeyboardFocus();
      FloatingLayer::preShow();
   }

   public method getSelectedOption() : int {
      return cm.getSelectedOption();
   }

}
